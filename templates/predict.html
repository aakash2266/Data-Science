{% extends "base.html" %}
{% block title %}Predict{% endblock %}

{% block main %}

<style>
  .predict-card {
      border-radius: 16px;
      padding: 24px;
  }

  .predict-label {
      font-size: 0.9rem;
      color: #e5e7eb !important;  /* LIGHT */
  }

  .predict-hint {
      font-size: 0.8rem;
      color: #9ca3af !important;
  }

  .predict-input {
      background-color: rgba(15, 23, 42, 0.95) !important;
      border: 1px solid rgba(148, 163, 184, 0.6) !important;
      color: #f9fafb !important;  /* WHITE TEXT */
  }

  .predict-input::placeholder {
      color: #94a3b8 !important;
  }

  .predict-input:focus {
      border-color: #3b82f6 !important;
      box-shadow: 0 0 0 1px #3b82f6;
      background-color: rgba(15, 23, 42, 1) !important;
      color: #ffffff !important;
  }

  .side-card-title {
      font-size: 1rem;
      font-weight: 600;
      color: #e5e7eb;
  }

  .side-card-text {
      font-size: 0.85rem;
      color: #cbd5f5;
  }

  .metric-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      background: rgba(37, 99, 235, 0.35);
      color: #bfdbfe;
      margin-right: 4px;
      margin-bottom: 4px;
  }

  .predict-layout {
      display: grid;
      grid-template-columns: minmax(0, 2fr) minmax(0, 1.2fr);
      gap: 18px;
  }

  @media (max-width: 768px) {
      .predict-layout {
          grid-template-columns: 1fr;
      }
  }
</style>

<div class="glass-card predict-card">
  <h3 class="mb-2" style="color:#f9fafb;">Predict Battery Drop</h3>
  <p class="small mb-4" style="color:#cbd5f5;">
      Enter your ride details below. The model will estimate the expected
      <strong>BatteryDrop_Percent</strong> for this trip.
  </p>

  <div class="predict-layout">

    <!-- LEFT: FORM -->
    <div>
      <form method="post" class="row g-3" id="predictForm">

        <div class="col-md-6">
          <label class="predict-label mb-1">Ride Distance (km)</label>
          <input
            type="number"
            step="any"
            name="feature1"
            class="form-control predict-input"
            placeholder="e.g. 12.5"
            required
          />
          <div class="predict-hint mt-1">Total distance for this trip.</div>
        </div>

        <div class="col-md-6">
          <label class="predict-label mb-1">Average Speed (km/h)</label>
          <input
            type="number"
            step="any"
            name="feature2"
            class="form-control predict-input"
            placeholder="e.g. 24"
            required
          />
          <div class="predict-hint mt-1">Approximate average riding speed.</div>
        </div>

        <div class="col-md-6">
          <label class="predict-label mb-1">Temperature (Â°C)</label>
          <input
            type="number"
            step="any"
            name="feature3"
            class="form-control predict-input"
            placeholder="e.g. 30"
            required
          />
          <div class="predict-hint mt-1">Higher temperatures can affect battery efficiency.</div>
        </div>

        <div class="col-md-6">
          <label class="predict-label mb-1">Rider Weight (kg)</label>
          <input
            type="number"
            step="any"
            name="feature4"
            class="form-control predict-input"
            placeholder="e.g. 70"
            required
          />
          <div class="predict-hint mt-1">Include backpack / extra load if any.</div>
        </div>

        <div class="col-12 mt-2 d-flex gap-2">
          <button type="submit" class="btn btn-success flex-grow-1">
            Predict Battery Drop
          </button>
          <button type="button" class="btn btn-outline-light" id="demoFillBtn">
            Demo Values
          </button>
        </div>
      </form>
    </div>

    <!-- RIGHT: INFO SIDE CARD -->
    <div class="glass-card" style="border-radius:14px; padding:16px;">
      <div class="side-card-title mb-1">What the model uses</div>
      <p class="side-card-text mb-2">
        This version uses a <strong>Linear Regression</strong> model with
        <strong>StandardScaler</strong> applied on inputs.
      </p>

      <div class="mb-2">
        <span class="metric-badge">RideDistance_km</span>
        <span class="metric-badge">AvgSpeed_kmh</span>
        <span class="metric-badge">Temperature_C</span>
        <span class="metric-badge">RiderWeight_kg</span>
      </div>

      <p class="side-card-text mb-0">
        You can later plug in more ML models (Random Forest, XGBoost, etc.) without changing this page.
      </p>
    </div>

  </div>
</div>

<script>
  function randomWithin(min, max) {
      return (Math.random() * (max - min) + min).toFixed(2);
  }

  document.getElementById("demoFillBtn").addEventListener("click", function () {
      const form = document.getElementById("predictForm");
      form.feature1.value = randomWithin(1, 25);   // RideDistance_km
      form.feature2.value = randomWithin(10, 35);  // AvgSpeed_kmh
      form.feature3.value = randomWithin(15, 40);  // Temperature_C
      form.feature4.value = randomWithin(40, 110); // RiderWeight_kg
  });
</script>

{% endblock %}
